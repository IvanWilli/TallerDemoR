<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Funciones | Taller de R aplicado a la Demografía</title>
  <meta name="description" content="5 Funciones | Taller de R aplicado a la Demografía" />
  <meta name="generator" content="bookdown 0.35 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Funciones | Taller de R aplicado a la Demografía" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="IvanWilli/TallerDemoR" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Funciones | Taller de R aplicado a la Demografía" />
  
  
  

<meta name="author" content="Ayelén Martinez, Florencia Bathory e Iván Williams" />


<meta name="date" content="2023-12-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ggplot.html"/>

<script src="libs/jquery/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook/css/style.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Taller de R aplicado a la demografía</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introducción</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#información-general"><i class="fa fa-check"></i><b>1.1</b> Información general</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#preparándonos"><i class="fa fa-check"></i><b>1.2</b> PrepaRándonos</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="index.html"><a href="index.html#instalación-de-y-rstudio"><i class="fa fa-check"></i><b>1.2.1</b> Instalación de y RStudio</a></li>
<li class="chapter" data-level="1.2.2" data-path="index.html"><a href="index.html#instalación-de-paquetes"><i class="fa fa-check"></i><b>1.2.2</b> Instalación de paquetes</a></li>
<li class="chapter" data-level="1.2.3" data-path="index.html"><a href="index.html#foro"><i class="fa fa-check"></i><b>1.2.3</b> Foro</a></li>
<li class="chapter" data-level="1.2.4" data-path="index.html"><a href="index.html#por-último"><i class="fa fa-check"></i><b>1.2.4</b> Por último</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#presentación-inicial"><i class="fa fa-check"></i><b>1.3</b> Presentación inicial</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> R Base</a>
<ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#el-proyecto-taller"><i class="fa fa-check"></i><b>2.1</b> El proyecto Taller</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="intro.html"><a href="intro.html#variables"><i class="fa fa-check"></i><b>2.1.1</b> Variables</a></li>
<li class="chapter" data-level="2.1.2" data-path="intro.html"><a href="intro.html#actividad"><i class="fa fa-check"></i><b>2.1.2</b> Actividad</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#vectores"><i class="fa fa-check"></i><b>2.2</b> Vectores</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="intro.html"><a href="intro.html#actividad-1"><i class="fa fa-check"></i><b>2.2.1</b> Actividad</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#data.frames"><i class="fa fa-check"></i><b>2.3</b> Data.frames</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="intro.html"><a href="intro.html#actividad-2"><i class="fa fa-check"></i><b>2.3.1</b> Actividad</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#listas"><i class="fa fa-check"></i><b>2.4</b> Listas</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="intro.html"><a href="intro.html#actividad-3"><i class="fa fa-check"></i><b>2.4.1</b> Actividad</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="intro.html"><a href="intro.html#referencias-y-materiales-adicionales"><i class="fa fa-check"></i><b>2.5</b> Referencias y materiales adicionales</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="dplyr.html"><a href="dplyr.html"><i class="fa fa-check"></i><b>3</b> dplyr</a>
<ul>
<li class="chapter" data-level="3.1" data-path="dplyr.html"><a href="dplyr.html#lectura-de-datos"><i class="fa fa-check"></i><b>3.1</b> Lectura de datos</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="dplyr.html"><a href="dplyr.html#acceso-a-archivos-no-locales"><i class="fa fa-check"></i><b>3.1.1</b> Acceso a archivos no locales</a></li>
<li class="chapter" data-level="3.1.2" data-path="dplyr.html"><a href="dplyr.html#actividad-4"><i class="fa fa-check"></i><b>3.1.2</b> Actividad</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="dplyr.html"><a href="dplyr.html#dplyr-1"><i class="fa fa-check"></i><b>3.2</b> dplyr</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="dplyr.html"><a href="dplyr.html#seleccionar-select-renombrar-rename"><i class="fa fa-check"></i><b>3.2.1</b> seleccionar (<strong>select</strong>), renombrar (<strong>rename</strong>)</a></li>
<li class="chapter" data-level="3.2.2" data-path="dplyr.html"><a href="dplyr.html#actividad-5"><i class="fa fa-check"></i><b>3.2.2</b> Actividad</a></li>
<li class="chapter" data-level="3.2.3" data-path="dplyr.html"><a href="dplyr.html#resumir-summarise-por-grupos-group_by"><i class="fa fa-check"></i><b>3.2.3</b> resumir (<strong>summarise</strong>) por grupos (<strong>group_by</strong>)</a></li>
<li class="chapter" data-level="3.2.4" data-path="dplyr.html"><a href="dplyr.html#transformar-mutate-filtrar-filter-ordenar-arrange"><i class="fa fa-check"></i><b>3.2.4</b> transformar (<strong>mutate</strong>), filtrar (<strong>filter</strong>), ordenar (<strong>arrange</strong>)</a></li>
<li class="chapter" data-level="3.2.5" data-path="dplyr.html"><a href="dplyr.html#actividad-6"><i class="fa fa-check"></i><b>3.2.5</b> Actividad</a></li>
<li class="chapter" data-level="3.2.6" data-path="dplyr.html"><a href="dplyr.html#recursos-adicionales"><i class="fa fa-check"></i><b>3.2.6</b> Recursos adicionales</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ggplot.html"><a href="ggplot.html"><i class="fa fa-check"></i><b>4</b> ggplot</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ggplot.html"><a href="ggplot.html#introducción-1"><i class="fa fa-check"></i><b>4.1</b> Introducción</a></li>
<li class="chapter" data-level="4.2" data-path="ggplot.html"><a href="ggplot.html#ggplot-1"><i class="fa fa-check"></i><b>4.2</b> ggplot</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="ggplot.html"><a href="ggplot.html#actividad-7"><i class="fa fa-check"></i><b>4.2.1</b> Actividad</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="ggplot.html"><a href="ggplot.html#lexis"><i class="fa fa-check"></i><b>4.3</b> Lexis</a></li>
<li class="chapter" data-level="4.4" data-path="ggplot.html"><a href="ggplot.html#estudio-de-cohorte-un-ejemplo"><i class="fa fa-check"></i><b>4.4</b> Estudio de cohorte: un ejemplo</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="ggplot.html"><a href="ggplot.html#actividad-8"><i class="fa fa-check"></i><b>4.4.1</b> Actividad</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="ggplot.html"><a href="ggplot.html#reproduciendo"><i class="fa fa-check"></i><b>4.5</b> Reproduciendo</a></li>
<li class="chapter" data-level="4.6" data-path="ggplot.html"><a href="ggplot.html#otras-visualizaciones"><i class="fa fa-check"></i><b>4.6</b> Otras visualizaciones</a></li>
<li class="chapter" data-level="4.7" data-path="ggplot.html"><a href="ggplot.html#material-adicional-y-no-tanto"><i class="fa fa-check"></i><b>4.7</b> Material adicional (y no tanto)</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="funciones.html"><a href="funciones.html"><i class="fa fa-check"></i><b>5</b> Funciones</a>
<ul>
<li class="chapter" data-level="5.1" data-path="funciones.html"><a href="funciones.html#demografía"><i class="fa fa-check"></i><b>5.1</b> DemogRafía</a></li>
<li class="chapter" data-level="5.2" data-path="funciones.html"><a href="funciones.html#funciones-1"><i class="fa fa-check"></i><b>5.2</b> Funciones</a></li>
<li class="chapter" data-level="5.3" data-path="funciones.html"><a href="funciones.html#crecimiento"><i class="fa fa-check"></i><b>5.3</b> Crecimiento</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="funciones.html"><a href="funciones.html#actividad-9"><i class="fa fa-check"></i><b>5.3.1</b> Actividad</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="funciones.html"><a href="funciones.html#estandarizando"><i class="fa fa-check"></i><b>5.4</b> Estandarizando</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="funciones.html"><a href="funciones.html#actividad-10"><i class="fa fa-check"></i><b>5.4.1</b> Actividad</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="funciones.html"><a href="funciones.html#funciones-demográficas-en-paquetes-demográficos"><i class="fa fa-check"></i><b>5.5</b> Funciones demográficas en paquetes demográficos</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="funciones.html"><a href="funciones.html#tablas-de-mortalidad"><i class="fa fa-check"></i><b>5.5.1</b> Tablas de mortalidad</a></li>
<li class="chapter" data-level="5.5.2" data-path="funciones.html"><a href="funciones.html#evaluación-de-declaración-de-edad"><i class="fa fa-check"></i><b>5.5.2</b> Evaluación de declaración de edad</a></li>
<li class="chapter" data-level="5.5.3" data-path="funciones.html"><a href="funciones.html#graduación-de-población-por-edad-simple"><i class="fa fa-check"></i><b>5.5.3</b> Graduación de población por edad simple</a></li>
<li class="chapter" data-level="5.5.4" data-path="funciones.html"><a href="funciones.html#actividad-11"><i class="fa fa-check"></i><b>5.5.4</b> Actividad</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><p>Taller de R aplicado a la Demografía</p></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="funciones" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">5</span> Funciones<a href="funciones.html#funciones" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="demografía" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> DemogRafía<a href="funciones.html#demografía" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>¿Qué es la demografía? Algunas definiciones (tomado de <a href="https://www.springer.com/gp/book/9783319232546">Carmichael, 2016</a>):</p>
<blockquote>
<p>Guillard (1855; citado en Shryock, Siegel and Associates, 1973): “la historia natural y social de la especie humana o el conocimiento matemático de las poblaciones, de sus cambios generales y de su condición física, civil, intelectual y moral”.</p>
</blockquote>
<blockquote>
<p>Hauser y Duncan (1959): La demografía es el estudio del tamaño, la distribución territorial y la composición de la población, los cambios en la misma y los componentes de dichos cambios, que pueden identificarse como natalidad, mortalidad, movimiento territorial (migración) y movilidad social (cambio de estado).</p>
</blockquote>
<blockquote>
<p>Weeks (1994): La demografía se refiere a prácticamente todo lo que influye, o puede ser influenciado por el tamaño de la población, su distribución, procesos, estructura o características de ella.</p>
</blockquote>
<blockquote>
<p>Preston et. al, (2001): cambios en su tamaño, sus tasas de crecimiento y su composición. La demografía es uno de las disciplinas de las ciencias sociales donde los análisis a nivel micro y macro encuentran quizás su más completa y satisfactoria articulación.</p>
</blockquote>
<p>Palabras clave: <em>especie + tamaño + composición + territorio + estado + cambio + micro/macro</em>.</p>
</div>
<div id="funciones-1" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Funciones<a href="funciones.html#funciones-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Una función consiste en <strong>encapsular</strong> un proceso, que recibe argumentos y devuelve un resultado. En general, si un bloque de código es copiado y pegado en más de una vez en un espacio de trabajo entonces merece su función. Las funciones en R contienen:</p>
<ul>
<li><p>un <strong>nombre</strong></p></li>
<li><p><strong>argumentos</strong> (input) ¿Qué necesita?</p></li>
<li><p><strong>cuerpo</strong> (código que elabora una respuesta en función de argumentos)</p></li>
<li><p><strong>respuesta</strong>/resultado (output). ¿Qué devuelve?</p></li>
</ul>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="funciones.html#cb161-1" tabindex="-1"></a>  <span class="co"># se enuncia entre llaves</span></span>
<span id="cb161-2"><a href="funciones.html#cb161-2" tabindex="-1"></a>  nombre<span class="ot">&lt;-</span> <span class="cf">function</span>(argumentos) { </span>
<span id="cb161-3"><a href="funciones.html#cb161-3" tabindex="-1"></a>    código</span>
<span id="cb161-4"><a href="funciones.html#cb161-4" tabindex="-1"></a>  <span class="fu">return</span>(resultado)</span>
<span id="cb161-5"><a href="funciones.html#cb161-5" tabindex="-1"></a>  }</span></code></pre></div>
<p>Por ejemplo, si queremos tener una función que nos diga cuantos años cumplidos tendrá una persona de edad <em>x</em> en <em>t</em> años:</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="funciones.html#cb162-1" tabindex="-1"></a>edad_en_t_anios <span class="ot">&lt;-</span> <span class="cf">function</span>(x, t){</span>
<span id="cb162-2"><a href="funciones.html#cb162-2" tabindex="-1"></a>  x_en_t_años <span class="ot">&lt;-</span> x <span class="sc">+</span> t</span>
<span id="cb162-3"><a href="funciones.html#cb162-3" tabindex="-1"></a>  <span class="co"># este valor solo existirá en este contexto (scoping)</span></span>
<span id="cb162-4"><a href="funciones.html#cb162-4" tabindex="-1"></a>  <span class="fu">return</span>(x_en_t_años)</span>
<span id="cb162-5"><a href="funciones.html#cb162-5" tabindex="-1"></a>}</span>
<span id="cb162-6"><a href="funciones.html#cb162-6" tabindex="-1"></a></span>
<span id="cb162-7"><a href="funciones.html#cb162-7" tabindex="-1"></a><span class="co"># Juan tiene 35. ¿Cuantos tendrá en 10 años?</span></span>
<span id="cb162-8"><a href="funciones.html#cb162-8" tabindex="-1"></a><span class="fu">edad_en_t_anios</span>(<span class="dv">35</span>, <span class="dv">10</span>) <span class="co"># no nombré los argumentos porque respeté el orden</span></span>
<span id="cb162-9"><a href="funciones.html#cb162-9" tabindex="-1"></a></span>
<span id="cb162-10"><a href="funciones.html#cb162-10" tabindex="-1"></a><span class="co"># Edades de un hogar en 5 años</span></span>
<span id="cb162-11"><a href="funciones.html#cb162-11" tabindex="-1"></a>edades <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">59</span>, <span class="dv">58</span>, <span class="dv">32</span>, <span class="dv">30</span>, <span class="dv">25</span>, <span class="dv">25</span>)</span>
<span id="cb162-12"><a href="funciones.html#cb162-12" tabindex="-1"></a><span class="fu">edad_en_t_anios</span>(edades, <span class="dv">5</span>)</span></code></pre></div>
<p>Las funciones pueden tener valores por defecto. Por ejemplo:</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="funciones.html#cb163-1" tabindex="-1"></a>edad_en_t_anios <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">t =</span> <span class="dv">5</span>){</span>
<span id="cb163-2"><a href="funciones.html#cb163-2" tabindex="-1"></a>  x_en_t_años <span class="ot">&lt;-</span> x <span class="sc">+</span> t</span>
<span id="cb163-3"><a href="funciones.html#cb163-3" tabindex="-1"></a>  <span class="fu">return</span>(x_en_t_años)</span>
<span id="cb163-4"><a href="funciones.html#cb163-4" tabindex="-1"></a>}</span>
<span id="cb163-5"><a href="funciones.html#cb163-5" tabindex="-1"></a></span>
<span id="cb163-6"><a href="funciones.html#cb163-6" tabindex="-1"></a><span class="fu">edad_en_t_anios</span>(<span class="at">x =</span> <span class="dv">35</span>)</span></code></pre></div>
</div>
<div id="crecimiento" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Crecimiento<a href="funciones.html#crecimiento" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Tenemos una población que en el año 2010 era de 50.000 personas y en 2020 era de 60.000. Nos preguntan cual sería la población a 2025. Existen distintas formas en que podemos modelar su crecimiento total a partir de dos puntos observados en el tiempo. En términos generales para un momento 0 y un momento t, debemos obtener primero el ritmo al que crece, es decir su tasa anual promedio <span class="math inline">\(\overline{r}(0,t)\)</span>:</p>
<table>
<thead>
<tr class="header">
<th>Supuesto</th>
<th><span class="math inline">\(N(t)\)</span></th>
<th><span class="math inline">\(\overline{r}(0,t)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Lineal</td>
<td><span class="math inline">\(N(0) * (1+r*t)\)</span></td>
<td><span class="math inline">\([\frac{N(t)}{N(0)}-1]/t\)</span></td>
</tr>
<tr class="even">
<td>Exponencial</td>
<td><span class="math inline">\(N(0) * e^{r * t}\)</span></td>
<td><span class="math inline">\(\ln(\frac{N(t)}{N(0)})/t\)</span></td>
</tr>
</tbody>
</table>
<!-- |Geométrica | $N(t) = N(0) * (1+r)^t$ | $r = [\frac{N(t)}{N(0)}-1]^{1/t}$ -->
<p>Construyamos una función para modelar su crecimiento y poder interpolar/extrapolar según el modelo <em>lineal</em>. Una función debe ser diseñada para ser aplicable a muchos casos específicos.
Llamaremos <code>h</code> a la distancia desde la primera observación para la que deseamos obtener la nueva población.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="funciones.html#cb164-1" tabindex="-1"></a>crecim_lineal <span class="ot">&lt;-</span> <span class="cf">function</span>(N0, Nt, t, h){</span>
<span id="cb164-2"><a href="funciones.html#cb164-2" tabindex="-1"></a>  r  <span class="ot">&lt;-</span> (Nt<span class="sc">/</span>N0<span class="dv">-1</span>)<span class="sc">/</span>t</span>
<span id="cb164-3"><a href="funciones.html#cb164-3" tabindex="-1"></a>  Nh <span class="ot">&lt;-</span> N0 <span class="sc">*</span> (<span class="dv">1</span><span class="sc">+</span>r<span class="sc">*</span>h)</span>
<span id="cb164-4"><a href="funciones.html#cb164-4" tabindex="-1"></a>  <span class="fu">return</span>(Nh)</span>
<span id="cb164-5"><a href="funciones.html#cb164-5" tabindex="-1"></a>}</span></code></pre></div>
<p>Nuestra respuesta a la pregunta inicial podría ser, siendo <code>h = 15</code>:</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="funciones.html#cb165-1" tabindex="-1"></a><span class="co"># ¿qué población habrá en 2025?</span></span>
<span id="cb165-2"><a href="funciones.html#cb165-2" tabindex="-1"></a>N2025 <span class="ot">&lt;-</span> <span class="fu">crecim_lineal</span>(<span class="at">N0 =</span> <span class="dv">50000</span>, <span class="at">Nt =</span> <span class="dv">60000</span>, <span class="at">t =</span> <span class="dv">10</span>, <span class="at">h =</span> <span class="dv">15</span>)</span>
<span id="cb165-3"><a href="funciones.html#cb165-3" tabindex="-1"></a></span>
<span id="cb165-4"><a href="funciones.html#cb165-4" tabindex="-1"></a><span class="co"># miremos un gráfico</span></span>
<span id="cb165-5"><a href="funciones.html#cb165-5" tabindex="-1"></a><span class="fu">data.frame</span>(Año <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">2010</span>,  <span class="dv">2020</span>,  <span class="dv">2025</span>),</span>
<span id="cb165-6"><a href="funciones.html#cb165-6" tabindex="-1"></a>       <span class="at">N   =</span> <span class="fu">c</span>(<span class="dv">50000</span>, <span class="dv">60000</span>, N2025)) <span class="sc">%&gt;%</span> </span>
<span id="cb165-7"><a href="funciones.html#cb165-7" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Año, N)) <span class="sc">+</span> </span>
<span id="cb165-8"><a href="funciones.html#cb165-8" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb165-9"><a href="funciones.html#cb165-9" tabindex="-1"></a>  <span class="fu">geom_point</span>() </span></code></pre></div>
<p><img src="talleR_files/figure-html/unnamed-chunk-151-1.png" width="672" /></p>
<p>¿Si quisiera tener opciones al momento de calcular el crecimiento? Por ejemplo, que sea de tipo lineal o exponencial. Incluyamos el argumento <code>tipo</code> y utilicemos el condicional <code>if</code> para posicionarnos en el modelo que se quiera.</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="funciones.html#cb166-1" tabindex="-1"></a>crecim <span class="ot">&lt;-</span> <span class="cf">function</span>(N0, Nt, t, h, <span class="at">tipo =</span> <span class="st">&quot;lineal&quot;</span>){</span>
<span id="cb166-2"><a href="funciones.html#cb166-2" tabindex="-1"></a>  <span class="co"># si se quiere el modelo exponencial</span></span>
<span id="cb166-3"><a href="funciones.html#cb166-3" tabindex="-1"></a>  <span class="cf">if</span>(tipo <span class="sc">==</span> <span class="st">&quot;exponencial&quot;</span>){</span>
<span id="cb166-4"><a href="funciones.html#cb166-4" tabindex="-1"></a>    r <span class="ot">&lt;-</span> <span class="fu">log</span>(Nt<span class="sc">/</span>N0)<span class="sc">/</span>t</span>
<span id="cb166-5"><a href="funciones.html#cb166-5" tabindex="-1"></a>    Nh <span class="ot">&lt;-</span> N0 <span class="sc">*</span> <span class="fu">exp</span>(r<span class="sc">*</span>h)  </span>
<span id="cb166-6"><a href="funciones.html#cb166-6" tabindex="-1"></a>  }</span>
<span id="cb166-7"><a href="funciones.html#cb166-7" tabindex="-1"></a>  <span class="co"># si se quiere el modelo lineal</span></span>
<span id="cb166-8"><a href="funciones.html#cb166-8" tabindex="-1"></a>  <span class="cf">if</span>(tipo <span class="sc">==</span> <span class="st">&quot;lineal&quot;</span>){</span>
<span id="cb166-9"><a href="funciones.html#cb166-9" tabindex="-1"></a>    Nh <span class="ot">&lt;-</span> <span class="fu">crecim_lineal</span>(N0, Nt, t, h) <span class="co"># una función dentro de otra!!!</span></span>
<span id="cb166-10"><a href="funciones.html#cb166-10" tabindex="-1"></a>  }</span>
<span id="cb166-11"><a href="funciones.html#cb166-11" tabindex="-1"></a>  <span class="fu">return</span>(Nh)</span>
<span id="cb166-12"><a href="funciones.html#cb166-12" tabindex="-1"></a>}</span></code></pre></div>
<p>Veamos que obtuvimos con las dos opciones:</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="funciones.html#cb167-1" tabindex="-1"></a>N2025 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">N2025_lineal =</span> <span class="fu">crecim</span>(<span class="dv">50000</span>, <span class="dv">60000</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="at">tipo =</span> <span class="st">&quot;lineal&quot;</span>),</span>
<span id="cb167-2"><a href="funciones.html#cb167-2" tabindex="-1"></a>                    <span class="at">N2025_exp    =</span> <span class="fu">crecim</span>(<span class="dv">50000</span>, <span class="dv">60000</span>, <span class="dv">10</span>, <span class="dv">15</span>, <span class="at">tipo =</span> <span class="st">&quot;exponencial&quot;</span>))</span>
<span id="cb167-3"><a href="funciones.html#cb167-3" tabindex="-1"></a></span>
<span id="cb167-4"><a href="funciones.html#cb167-4" tabindex="-1"></a><span class="fu">data.frame</span>(Año <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">2010</span>,  <span class="dv">2020</span>,  <span class="dv">2025</span>, <span class="dv">2025</span>),</span>
<span id="cb167-5"><a href="funciones.html#cb167-5" tabindex="-1"></a>           <span class="at">N   =</span> <span class="fu">c</span>(<span class="dv">50000</span>, <span class="dv">60000</span>, N2025<span class="sc">$</span>N2025_lineal, N2025<span class="sc">$</span>N2025_exp),</span>
<span id="cb167-6"><a href="funciones.html#cb167-6" tabindex="-1"></a>           <span class="at">Tipo =</span> <span class="fu">c</span>(<span class="st">&quot;Observado&quot;</span>, <span class="st">&quot;Observado&quot;</span>, <span class="st">&quot;lineal&quot;</span>, <span class="st">&quot;exponencial&quot;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb167-7"><a href="funciones.html#cb167-7" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Año, N)) <span class="sc">+</span> </span>
<span id="cb167-8"><a href="funciones.html#cb167-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">shape =</span> Tipo, <span class="at">color=</span>Tipo)) </span></code></pre></div>
<p><img src="talleR_files/figure-html/unnamed-chunk-153-1.png" width="672" /></p>
<p>El condicional puede pensarse como <code>if</code> y <code>else</code> también, ¿cómo sería?</p>
<p>¿Y si tuviéramos un vector de población por edad? Podemos tener una tasa <span class="math inline">\(\overline{r}(0,t)\)</span> por cada edad.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="funciones.html#cb168-1" tabindex="-1"></a><span class="co"># crecimiento por edad</span></span>
<span id="cb168-2"><a href="funciones.html#cb168-2" tabindex="-1"></a>N2025_edad <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Edad =</span> <span class="fu">c</span>(<span class="st">&quot;0-14&quot;</span>, <span class="st">&quot;15-64&quot;</span>, <span class="st">&quot;65+&quot;</span>), </span>
<span id="cb168-3"><a href="funciones.html#cb168-3" tabindex="-1"></a>                         <span class="at">N2010   =</span> <span class="fu">c</span>(<span class="dv">20000</span>, <span class="dv">20000</span>, <span class="dv">10000</span>),</span>
<span id="cb168-4"><a href="funciones.html#cb168-4" tabindex="-1"></a>                         <span class="at">N2020   =</span> <span class="fu">c</span>(<span class="dv">25000</span>, <span class="dv">30000</span>, <span class="dv">5000</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb168-5"><a href="funciones.html#cb168-5" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">N2025_lineal =</span> <span class="fu">crecim</span>(N2010, N2020, <span class="dv">10</span>, <span class="dv">15</span>, <span class="at">tipo =</span> <span class="st">&quot;lineal&quot;</span>),</span>
<span id="cb168-6"><a href="funciones.html#cb168-6" tabindex="-1"></a>                     <span class="at">N2025_exp =</span> <span class="fu">crecim</span>(N2010, N2020, <span class="dv">10</span>, <span class="dv">15</span>, <span class="at">tipo =</span> <span class="st">&quot;exponencial&quot;</span>))</span>
<span id="cb168-7"><a href="funciones.html#cb168-7" tabindex="-1"></a></span>
<span id="cb168-8"><a href="funciones.html#cb168-8" tabindex="-1"></a><span class="co"># hagamos tidy el data.frame primero</span></span>
<span id="cb168-9"><a href="funciones.html#cb168-9" tabindex="-1"></a>N2025_edad <span class="sc">%&gt;%</span> </span>
<span id="cb168-10"><a href="funciones.html#cb168-10" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="sc">!</span>Edad, <span class="at">names_to =</span> <span class="st">&quot;Tipo&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;N&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb168-11"><a href="funciones.html#cb168-11" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Edad, N, <span class="at">fill =</span> Tipo)) <span class="sc">+</span> </span>
<span id="cb168-12"><a href="funciones.html#cb168-12" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="co"># no trates de ser un histograma</span></span>
<span id="cb168-13"><a href="funciones.html#cb168-13" tabindex="-1"></a>           <span class="at">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="co"># posición lado a lado</span></span></code></pre></div>
<p><img src="talleR_files/figure-html/unnamed-chunk-154-1.png" width="672" /></p>
<p>El poner a disposición de otros usuarios tus funciones requiere controlar los errores posibles, entre otras cosas por ingresar como argumentos objetos no esperados (por ejemplo, un objeto <em>character</em> en algunos de los primeros argumentos). Ejemplo: hagamos no aceptable el ingreso de un objeto <code>character</code> como argumento en <code>N0</code>, <code>Nt</code>, <code>t</code> ni <code>h</code>:</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="funciones.html#cb169-1" tabindex="-1"></a>crecim_lineal_check <span class="ot">&lt;-</span> <span class="cf">function</span>(N0, Nt, t, h){</span>
<span id="cb169-2"><a href="funciones.html#cb169-2" tabindex="-1"></a>  <span class="co"># check argumentos</span></span>
<span id="cb169-3"><a href="funciones.html#cb169-3" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.character</span>(N0) <span class="sc">|</span> <span class="fu">is.character</span>(Nt) <span class="sc">|</span> <span class="fu">is.character</span>(t) <span class="sc">|</span> <span class="fu">is.character</span>(h)){</span>
<span id="cb169-4"><a href="funciones.html#cb169-4" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Ingresaste un texto en algún argumento&quot;</span>)</span>
<span id="cb169-5"><a href="funciones.html#cb169-5" tabindex="-1"></a>  }</span>
<span id="cb169-6"><a href="funciones.html#cb169-6" tabindex="-1"></a>  <span class="co"># función previa</span></span>
<span id="cb169-7"><a href="funciones.html#cb169-7" tabindex="-1"></a>  r  <span class="ot">&lt;-</span> (Nt<span class="sc">/</span>N0<span class="dv">-1</span>)<span class="sc">/</span>t</span>
<span id="cb169-8"><a href="funciones.html#cb169-8" tabindex="-1"></a>  Nh <span class="ot">&lt;-</span> N0 <span class="sc">*</span> (<span class="dv">1</span><span class="sc">+</span>r<span class="sc">*</span>h)</span>
<span id="cb169-9"><a href="funciones.html#cb169-9" tabindex="-1"></a>  <span class="fu">return</span>(Nh)</span>
<span id="cb169-10"><a href="funciones.html#cb169-10" tabindex="-1"></a>}</span>
<span id="cb169-11"><a href="funciones.html#cb169-11" tabindex="-1"></a></span>
<span id="cb169-12"><a href="funciones.html#cb169-12" tabindex="-1"></a><span class="co"># probemos</span></span>
<span id="cb169-13"><a href="funciones.html#cb169-13" tabindex="-1"></a><span class="fu">crecim_lineal_check</span>(<span class="dv">50000</span>, <span class="dv">60000</span>, <span class="dv">10</span>, <span class="st">&quot;hola&quot;</span>)</span></code></pre></div>
<div id="actividad-9" class="section level3 hasAnchor" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> Actividad<a href="funciones.html#actividad-9" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: lower-alpha">
<li>Crear una función que sume un vector de población y devuelva el resultado en miles.</li>
</ol>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="funciones.html#cb170-1" tabindex="-1"></a>sumar_en_miles <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb170-2"><a href="funciones.html#cb170-2" tabindex="-1"></a>  <span class="fu">round</span>(<span class="fu">sum</span>(x)<span class="sc">/</span><span class="dv">1000</span>)</span>
<span id="cb170-3"><a href="funciones.html#cb170-3" tabindex="-1"></a>}</span>
<span id="cb170-4"><a href="funciones.html#cb170-4" tabindex="-1"></a><span class="fu">sumar_en_miles</span>(N2025_edad<span class="sc">$</span>N2010)</span></code></pre></div>
<ol style="list-style-type: lower-alpha">
<li><p>Siguiendo el ejemplo trabajado: ¿cuál sería la población al 2017 bajo el supuesto de crecimiento exponencial? ¿Es equivalente interpolar cada edad y luego sumar? ¿Y para el tipo lineal?</p></li>
<li><p>Crear una función que informe la edad modal, por ejemplo para <code>data.frame(Edad = c(0,4,7,10), Casos = c(2, 6, 9, 0))</code> debería devolver la edad 7.</p></li>
<li><p>Obtener una función que permita conocer en cuantos años (h) se duplicará la población respecto al primer valor observado, bajo el supuesto de crecimiento lineal y exponencial. (Ayuda: obtén <span class="math inline">\(r\)</span> y luego despeja <span class="math inline">\(h\)</span> para que <span class="math inline">\(N_h=N_0*2\)</span>).</p></li>
</ol>
</div>
</div>
<div id="estandarizando" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Estandarizando<a href="funciones.html#estandarizando" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Entre los intentos por discriminar el efecto de la estructura por edad en el indicador de Tasa Bruta de Mortalidad <span class="math inline">\(TBM(t)=\frac{D(t)}{N(t)}\)</span> (defunciones sobre población expuesta<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>) se encuentra el clásico método de <em>estandarización</em> directa (Swanson &amp; Siegel, 2004).</p>
<p>En principio, la <span class="math inline">\(TBM(t)\)</span> de una población puede ser expresada como el promedio ponderado de las tasas específicas de mortalidad <span class="math inline">\(M_x(t)=\frac{D_x(t)}{N_x(t)}\)</span> por el peso poblacional de cada edad <span class="math inline">\(C_x(t)=\frac{N_x(t)}{N(t)}\)</span>:</p>
<p><span class="math display">\[
TBM(t) = \frac{D(t)}{N(t)}= \sum_{x&gt;=0}{M_x(t)\,C_x(t)}
\]</span></p>
<p>Poblaciones envejecidas tendrán una mayor frecuencia de muertes debido a la distribución de <span class="math inline">\(C_x(t)\)</span>, pero no reflejando su nivel. El proceso de estandarización reemplaza <span class="math inline">\(C_x(t)\)</span> por otra distribución que permita la comparación entre distintas poblaciones: sería equivalente a asignarle <strong>una misma pirámide poblacional</strong> a ambas poblaciones. Si llamamos a esta distribución <em>estándar</em> tenemos <span class="math inline">\(C^S_x(t)\)</span> y podemos calcular para dos poblaciones cualquiera <span class="math inline">\(A\)</span> y <span class="math inline">\(B\)</span> su Tasa Estandarizada de Mortalidad:</p>
<p><span class="math display">\[
TSM^A(t) = \sum_{x&gt;=0}{M^A_x(t)\,C^S_x(t)}\\
TSM^B(t) = \sum_{x&gt;=0}{M^B_x(t)\,C^S_x(t)}\\
\]</span></p>
<p>Lo que permite comparar <span class="math inline">\(TSM^A(t)\)</span> con <span class="math inline">\(TSM^B(t)\)</span>: <span class="math inline">\(TSM^A(t) \lessgtr TSM^A(t)\)</span>. Pero vayamos al ejemplo!!!</p>
<p>Obtengamos la población y defunciones de Chile, Japón y Polonia del año 2000 y 2010 leyendo la tabla “Chile_Japon_Polonia.csv” en la carpeta “Data”. ¿Cómo obtuve esta información? Directamente desde R hacia el repositorio de la <a href="https://www.mortality.org/">Human Mortality Database</a>, utilizando el paquete <code>HMDHFDplus</code>. Por ejemplo en este caso las defunciones de Chile por grupos quinquenales de edad (en realidad se muestra la edad inicial de cada intervalo) cada 5 años calendario, “Deaths_5x5”, se pueden obtener con la función <code>readHMDweb</code>.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="funciones.html#cb171-1" tabindex="-1"></a>db <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_xlsx</span>(<span class="st">&quot;Data/Chile_Japon_Polonia.xlsx&quot;</span>)</span></code></pre></div>
<p>Enfoquémonos en el 2010 para comparar los tres países. Japón presenta una <span class="math inline">\(TBM\)</span> mayor pero atribuible a otro estadío en su envejecimiento según la porción de población de 65 años y más.</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="funciones.html#cb172-1" tabindex="-1"></a>db <span class="ot">&lt;-</span> db <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Year <span class="sc">==</span> <span class="dv">2010</span>)</span>
<span id="cb172-2"><a href="funciones.html#cb172-2" tabindex="-1"></a></span>
<span id="cb172-3"><a href="funciones.html#cb172-3" tabindex="-1"></a>db <span class="sc">%&gt;%</span> </span>
<span id="cb172-4"><a href="funciones.html#cb172-4" tabindex="-1"></a>  <span class="fu">group_by</span>(Country) <span class="sc">%&gt;%</span> </span>
<span id="cb172-5"><a href="funciones.html#cb172-5" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TBM =</span> <span class="fu">sum</span>(D)<span class="sc">/</span><span class="fu">sum</span>(N)<span class="sc">*</span><span class="dv">1000</span>,</span>
<span id="cb172-6"><a href="funciones.html#cb172-6" tabindex="-1"></a>            <span class="at">porc_65_mas =</span> <span class="fu">sum</span>(N[Age<span class="sc">&gt;=</span><span class="dv">65</span>])<span class="sc">/</span><span class="fu">sum</span>(N)) </span></code></pre></div>
<p>Y esto es visible en la jerarquía de las tasas de mortalidad por edad:</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="funciones.html#cb173-1" tabindex="-1"></a><span class="co"># creamos la varibale con las tasas de mortalidad específicas</span></span>
<span id="cb173-2"><a href="funciones.html#cb173-2" tabindex="-1"></a>db <span class="ot">&lt;-</span> db <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">M =</span> D<span class="sc">/</span>N)</span>
<span id="cb173-3"><a href="funciones.html#cb173-3" tabindex="-1"></a></span>
<span id="cb173-4"><a href="funciones.html#cb173-4" tabindex="-1"></a><span class="fu">ggplot</span>(db)  <span class="sc">+</span></span>
<span id="cb173-5"><a href="funciones.html#cb173-5" tabindex="-1"></a>  <span class="fu">geom_step</span>(<span class="fu">aes</span>(<span class="at">x=</span>Age,<span class="at">y=</span>M,<span class="at">color=</span>Country))<span class="sc">+</span></span>
<span id="cb173-6"><a href="funciones.html#cb173-6" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>()<span class="sc">+</span></span>
<span id="cb173-7"><a href="funciones.html#cb173-7" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">110</span>,<span class="dv">10</span>), <span class="at">labels =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">110</span>,<span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb173-8"><a href="funciones.html#cb173-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">caption =</span> <span class="st">&quot;Human Mortality Database&quot;</span>)<span class="sc">+</span></span>
<span id="cb173-9"><a href="funciones.html#cb173-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="talleR_files/figure-html/unnamed-chunk-163-1.png" width="672" /></p>
<p>Estandaricemos utilizando el promedio de la estructura por edad de los tres:</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="funciones.html#cb174-1" tabindex="-1"></a>C_x_promedio <span class="ot">&lt;-</span> db <span class="sc">%&gt;%</span> </span>
<span id="cb174-2"><a href="funciones.html#cb174-2" tabindex="-1"></a>              <span class="fu">group_by</span>(Age) <span class="sc">%&gt;%</span> </span>
<span id="cb174-3"><a href="funciones.html#cb174-3" tabindex="-1"></a>              <span class="fu">summarise</span>(<span class="at">c_x =</span> <span class="fu">sum</span>(N)<span class="sc">/</span><span class="fu">sum</span>(db<span class="sc">$</span>N))</span>
<span id="cb174-4"><a href="funciones.html#cb174-4" tabindex="-1"></a></span>
<span id="cb174-5"><a href="funciones.html#cb174-5" tabindex="-1"></a>db <span class="sc">%&gt;%</span></span>
<span id="cb174-6"><a href="funciones.html#cb174-6" tabindex="-1"></a>  <span class="fu">left_join</span>(C_x_promedio) <span class="sc">%&gt;%</span> </span>
<span id="cb174-7"><a href="funciones.html#cb174-7" tabindex="-1"></a>  <span class="fu">group_by</span>(Country) <span class="sc">%&gt;%</span> </span>
<span id="cb174-8"><a href="funciones.html#cb174-8" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">TSM =</span> <span class="fu">sum</span>(M <span class="sc">*</span> c_x)<span class="sc">*</span><span class="dv">1000</span>)</span></code></pre></div>
<p>!Ahora sí! El indicador nos muestra un nivel de mortalidad para 2010 mayor en Polonia, seguido de Chile y Japón. Cabe aclarar que en este sentido el mejor indicador resumen es la esperanzada de vida (<span class="math inline">\(e_x\)</span>), que se estima a partir de la construcción de una tabla de vida (Preston y otros, 2001).</p>
<p>¿Cómo sería una función que reciba una tabla con las variables <code>País</code>, <code>N</code> y <code>D</code> y devuelva las <span class="math inline">\(TBM\)</span> y las <span class="math inline">\(TSM\)</span>?</p>
<div id="actividad-10" class="section level3 hasAnchor" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> Actividad<a href="funciones.html#actividad-10" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: lower-alpha">
<li><p>Responder la pregunta previa con los mismos datos utilizados arriba.</p></li>
<li><p>Con los datos de la tabla “Chile_Japon_Polonia.csv”: ¿qué se puede decir sobre la evolución de la mortalidad de Polonia en los años 1990, 2000 y 2010? ¿Bajó o creció?</p></li>
<li><p>Graficar la distribución de las defunciones por edad (colocando cada punto en la edad media del intervalo, por ejemplo para el grupo 5-10, en 7.5).</p></li>
</ol>
</div>
</div>
<div id="funciones-demográficas-en-paquetes-demográficos" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Funciones demográficas en paquetes demográficos<a href="funciones.html#funciones-demográficas-en-paquetes-demográficos" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
<p>Estamos entrando en zona de utilización de funciones demográficas de paquetes.</p>
</blockquote>
<p>Proyecto <a href="https://timriffe.github.io/DemoTools/">DemoTools</a>. Su instalación demora un poco:</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="funciones.html#cb175-1" tabindex="-1"></a><span class="fu">library</span>(devtools)</span>
<span id="cb175-2"><a href="funciones.html#cb175-2" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;rstan&quot;</span>, <span class="at">repos =</span> <span class="fu">c</span>(<span class="st">&quot;https://mc-stan.org/r-packages/&quot;</span>, <span class="fu">getOption</span>(<span class="st">&quot;repos&quot;</span>)))</span>
<span id="cb175-3"><a href="funciones.html#cb175-3" tabindex="-1"></a><span class="fu">install_github</span>(<span class="st">&quot;timriffe/DemoTools&quot;</span>)</span></code></pre></div>
<div id="tablas-de-mortalidad" class="section level3 hasAnchor" number="5.5.1">
<h3><span class="header-section-number">5.5.1</span> Tablas de mortalidad<a href="funciones.html#tablas-de-mortalidad" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Construir una función que produzca una <strong>tabla de mortalidad</strong> a partir de un set de tasas por edad de mortalidad es un lindo ejercicio de programación en R. Pero por suerte <code>DemoTools</code> tiene una muy buena implementación. Acá para Japón 2010:</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="funciones.html#cb176-1" tabindex="-1"></a>jpn_2010 <span class="ot">&lt;-</span> db <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Country <span class="sc">==</span> <span class="st">&quot;Japon&quot;</span>, Year <span class="sc">==</span> <span class="dv">2010</span>)</span>
<span id="cb176-2"><a href="funciones.html#cb176-2" tabindex="-1"></a></span>
<span id="cb176-3"><a href="funciones.html#cb176-3" tabindex="-1"></a><span class="co"># obtengo la tabla</span></span>
<span id="cb176-4"><a href="funciones.html#cb176-4" tabindex="-1"></a><span class="fu">library</span>(DemoTools)</span>
<span id="cb176-5"><a href="funciones.html#cb176-5" tabindex="-1"></a>tm_jpn_2010 <span class="ot">&lt;-</span> <span class="fu">lt_abridged</span>(<span class="at">nMx =</span> jpn_2010<span class="sc">$</span>M, <span class="at">Age =</span> jpn_2010<span class="sc">$</span>Age)</span>
<span id="cb176-6"><a href="funciones.html#cb176-6" tabindex="-1"></a></span>
<span id="cb176-7"><a href="funciones.html#cb176-7" tabindex="-1"></a><span class="co"># veamos la función de sobrevivencia:</span></span>
<span id="cb176-8"><a href="funciones.html#cb176-8" tabindex="-1"></a>tm_jpn_2010 <span class="sc">%&gt;%</span> </span>
<span id="cb176-9"><a href="funciones.html#cb176-9" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(Age, lx)) <span class="sc">+</span> </span>
<span id="cb176-10"><a href="funciones.html#cb176-10" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb176-11"><a href="funciones.html#cb176-11" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb176-12"><a href="funciones.html#cb176-12" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="talleR_files/figure-html/unnamed-chunk-170-1.png" width="672" /></p>
<p>Repasemos sus argumentos, como <code>OAGNew</code>, <code>extrapLaw</code> y <code>a0rule</code>. También puede <code>graduar</code>, es decir pasar a edades simples.</p>
</div>
<div id="evaluación-de-declaración-de-edad" class="section level3 hasAnchor" number="5.5.2">
<h3><span class="header-section-number">5.5.2</span> Evaluación de declaración de edad<a href="funciones.html#evaluación-de-declaración-de-edad" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Con el índice de <strong>Myers</strong> veamos si en Chaco mejoró la declaración por edad de varones entre los censos 2001 y 2010. Un valor del indicador que tienda a 0 indica una mejor declaración (bajo los supuesto del método).</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="funciones.html#cb177-1" tabindex="-1"></a>pob_chaco <span class="ot">&lt;-</span> readxl<span class="sc">::</span><span class="fu">read_xlsx</span>(<span class="st">&quot;Data/PoblCensal01y10.xlsx&quot;</span>, <span class="at">sheet=</span><span class="dv">1</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb177-2"><a href="funciones.html#cb177-2" tabindex="-1"></a>                <span class="fu">filter</span>(PROV_NOMBRE <span class="sc">==</span> <span class="st">&quot;CHACO&quot;</span>)</span>
<span id="cb177-3"><a href="funciones.html#cb177-3" tabindex="-1"></a></span>
<span id="cb177-4"><a href="funciones.html#cb177-4" tabindex="-1"></a>pob_chaco <span class="sc">%&gt;%</span> </span>
<span id="cb177-5"><a href="funciones.html#cb177-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(EDAD, VARON, <span class="at">color=</span><span class="fu">factor</span>(CENSO))) <span class="sc">+</span> </span>
<span id="cb177-6"><a href="funciones.html#cb177-6" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb177-7"><a href="funciones.html#cb177-7" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb177-8"><a href="funciones.html#cb177-8" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">5</span>), <span class="at">labels =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>,<span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb177-9"><a href="funciones.html#cb177-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="talleR_files/figure-html/unnamed-chunk-171-1.png" width="672" /></p>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="funciones.html#cb178-1" tabindex="-1"></a><span class="co"># obtengo Myers</span></span>
<span id="cb178-2"><a href="funciones.html#cb178-2" tabindex="-1"></a>pob_chaco <span class="sc">%&gt;%</span></span>
<span id="cb178-3"><a href="funciones.html#cb178-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">Myers_2001 =</span> <span class="fu">check_heaping_myers</span>(VARON[CENSO<span class="sc">==</span><span class="dv">2001</span>], EDAD[CENSO<span class="sc">==</span><span class="dv">2001</span>], <span class="at">ageMin =</span> <span class="dv">20</span>, <span class="at">ageMax =</span> <span class="dv">64</span>),</span>
<span id="cb178-4"><a href="funciones.html#cb178-4" tabindex="-1"></a>            <span class="at">Myers_2010 =</span> <span class="fu">check_heaping_myers</span>(VARON[CENSO<span class="sc">==</span><span class="dv">2010</span>], EDAD[CENSO<span class="sc">==</span><span class="dv">2010</span>], <span class="at">ageMin =</span> <span class="dv">20</span>, <span class="at">ageMax =</span> <span class="dv">64</span>))</span></code></pre></div>
</div>
<div id="graduación-de-población-por-edad-simple" class="section level3 hasAnchor" number="5.5.3">
<h3><span class="header-section-number">5.5.3</span> Graduación de población por edad simple<a href="funciones.html#graduación-de-población-por-edad-simple" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>El método de <strong>Sprague</strong> desagrega por edad simple conteos agrupados por edad quinquenal. Veamos como funciona para los varones de Chaco en el año 2010. Primero agregando, y luego aplicando el método.</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="funciones.html#cb179-1" tabindex="-1"></a><span class="co"># me quedo con 2010</span></span>
<span id="cb179-2"><a href="funciones.html#cb179-2" tabindex="-1"></a>pob_chaco_2010 <span class="ot">&lt;-</span> pob_chaco <span class="sc">%&gt;%</span> <span class="fu">filter</span>(CENSO <span class="sc">==</span> <span class="dv">2010</span>)</span>
<span id="cb179-3"><a href="funciones.html#cb179-3" tabindex="-1"></a></span>
<span id="cb179-4"><a href="funciones.html#cb179-4" tabindex="-1"></a><span class="co"># agrupo la población por grupos quinquenales</span></span>
<span id="cb179-5"><a href="funciones.html#cb179-5" tabindex="-1"></a>pob_chaco_2010_quinquenal <span class="ot">&lt;-</span> pob_chaco <span class="sc">%&gt;%</span></span>
<span id="cb179-6"><a href="funciones.html#cb179-6" tabindex="-1"></a>  <span class="fu">filter</span>(CENSO <span class="sc">==</span> <span class="dv">2010</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb179-7"><a href="funciones.html#cb179-7" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">EDAD_q =</span> <span class="fu">trunc</span>(EDAD<span class="sc">/</span><span class="dv">5</span>) <span class="sc">*</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb179-8"><a href="funciones.html#cb179-8" tabindex="-1"></a>  <span class="fu">group_by</span>(EDAD_q) <span class="sc">%&gt;%</span> </span>
<span id="cb179-9"><a href="funciones.html#cb179-9" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">VARON =</span> <span class="fu">sum</span>(VARON))</span>
<span id="cb179-10"><a href="funciones.html#cb179-10" tabindex="-1"></a></span>
<span id="cb179-11"><a href="funciones.html#cb179-11" tabindex="-1"></a><span class="co"># aplico sprague</span></span>
<span id="cb179-12"><a href="funciones.html#cb179-12" tabindex="-1"></a>pob_chaco_2010_sprague <span class="ot">&lt;-</span> <span class="fu">graduate</span>(pob_chaco_2010_quinquenal<span class="sc">$</span>VARON, pob_chaco_2010_quinquenal<span class="sc">$</span>EDAD_q, <span class="at">method =</span> <span class="st">&quot;sprague&quot;</span>)</span>
<span id="cb179-13"><a href="funciones.html#cb179-13" tabindex="-1"></a></span>
<span id="cb179-14"><a href="funciones.html#cb179-14" tabindex="-1"></a><span class="co"># junto</span></span>
<span id="cb179-15"><a href="funciones.html#cb179-15" tabindex="-1"></a>pob_chaco_2010_simple <span class="ot">&lt;-</span> pob_chaco_2010 <span class="sc">%&gt;%</span> </span>
<span id="cb179-16"><a href="funciones.html#cb179-16" tabindex="-1"></a>  <span class="fu">full_join</span>(<span class="fu">tibble</span>(<span class="at">EDAD =</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">110</span>, <span class="at">VARON_sprague =</span> pob_chaco_2010_sprague)) <span class="sc">%&gt;%</span> </span>
<span id="cb179-17"><a href="funciones.html#cb179-17" tabindex="-1"></a>  <span class="fu">select</span>(EDAD, VARON, VARON_sprague) <span class="sc">%&gt;%</span> </span>
<span id="cb179-18"><a href="funciones.html#cb179-18" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">!</span>EDAD, <span class="at">names_to=</span><span class="st">&quot;Tipo&quot;</span>, <span class="at">values_to=</span><span class="st">&quot;Población&quot;</span>)</span>
<span id="cb179-19"><a href="funciones.html#cb179-19" tabindex="-1"></a></span>
<span id="cb179-20"><a href="funciones.html#cb179-20" tabindex="-1"></a><span class="co"># visualizo</span></span>
<span id="cb179-21"><a href="funciones.html#cb179-21" tabindex="-1"></a>pob_chaco_2010_simple <span class="sc">%&gt;%</span> </span>
<span id="cb179-22"><a href="funciones.html#cb179-22" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(EDAD, Población, <span class="at">color=</span>Tipo)) <span class="sc">+</span></span>
<span id="cb179-23"><a href="funciones.html#cb179-23" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb179-24"><a href="funciones.html#cb179-24" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="talleR_files/figure-html/unnamed-chunk-172-1.png" width="672" /></p>
</div>
<div id="actividad-11" class="section level3 hasAnchor" number="5.5.4">
<h3><span class="header-section-number">5.5.4</span> Actividad<a href="funciones.html#actividad-11" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: lower-alpha">
<li>Evaluar la declaración en edades terminadas en 0 y 5 con el indicador <em>Whipple</em>, para la provincia que prefiera. ¿qué conclusión puede obtener?</li>
</ol>

</div>
</div>
</div>







<div class="footnotes">
<hr />
<ol start="2">
<li id="fn2"><p>Para ser más rigurosos en la notación <span class="math inline">\(N(t)\)</span> debería ser expresado como <span class="math inline">\(\overline{N}(t,t+1)\)</span>, pero simplificaremos un poco para enfocarnos en lo que haremos en R. Para más detalles ver Preston y otros (2001)<a href="funciones.html#fnref2" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ggplot.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook/js/app.min.js"></script>
<script src="libs/gitbook/js/clipboard.min.js"></script>
<script src="libs/gitbook/js/plugin-search.js"></script>
<script src="libs/gitbook/js/plugin-sharing.js"></script>
<script src="libs/gitbook/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook/js/plugin-bookdown.js"></script>
<script src="libs/gitbook/js/jquery.highlight.js"></script>
<script src="libs/gitbook/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/04-funciones.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["https://github.com/rstudio/bookdown-demo/raw/master/04-funciones.Rmd"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
